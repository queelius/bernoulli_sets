%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Higher-order distributions
% (Merged from bernoulli_sets_higher_order)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Probability distributions of parameters for \emph{higher-order} approximations}
\label{sec:characteristics2}

The false negative rate is a random variable that is a mixture of binomially distributed random variables and likewise for the false positive rate.
We characterize their error rates by their expected values and variance and show their normal approximation when the sampling distribution of these rates are important.

\subsection{Compositions of random approximate sets}
\label{sec:compositions}

By \cref{sec:set_theory}, set-theoretic operations on random approximate sets produce random approximate sets whose error rates depend on the input error rates and set structure.
The union of two first-order random approximate sets $\ASet{A}[\epsilon_1]$ and $\ASet{B}[\epsilon_2]$ is up to a \emph{third-order} random approximate set with a random error rate given by
\begin{equation}
	\Delta = \sum_{j=1}^{3} w_j \RV{X_j}
\end{equation}
with an expectation
\begin{equation}
	\epsilon = w_1 (1-\epsilon_1)\epsilon_2 + w_2 (1-\epsilon_2)\epsilon_1 + (1-w_1 - w_2 - w_3)\epsilon_1 \epsilon_2\,,
\end{equation}
where $w_1 \coloneqq \frac{\Card{\Set{A} \SetDiff \Set{B}}}{\Card{\Set{U}}}$, $w_2 \coloneqq \frac{\Card{\Set{B} \SetDiff \Set{A}}}{\Card{\Set{U}}}$, and $w_3 \coloneqq \frac{\Card{\Set{A} \SetIntersection \Set{B}}}{\Card{\Set{U}}}$.

The error rates of set-theoretic operations (union, intersection, complement, set difference) are derived in detail in \cref{sec:set_theory}.
Here we note the asymptotic distributions that arise.

\subsection{Normal approximation of composed error rates}

The limiting probability distribution of the uncertain true negative rate of the union of $\ASet{A}$ and $\ASet{B}$ is
\begin{equation}
\TNR_\n \sim \normdist\!\left(\tnrate_1 \tnrate_2, \frac{\tnrate_1 \tnrate_2 (1-\tnrate_1 \tnrate_2)}{\n}\right)
\end{equation}
where the number of negatives $\n = u - \Card{\SetUnion[\Set{A}][\Set{B}]} \leq u$, which is a value between $0$ and $u$. Since this is a limiting distribution, presumably $\n$ is large, and as $\n \to \infty$ the distribution converges in probability to $\tnrate_1 \tnrate_2$.

Generally, the number of negatives $\n$ or positives $\p$ is not known, and so this serves a more analytic function, i.e., given around $\n$ negatives, what true negative rate $\tnrate$ provides the desired level of confidence that the true negative rate will not realize a value less than some specified value?

\begin{remark}
	Consider a sequence $\PASet{A}[\fprate_1],\ldots,\PASet{A}[\fprate_n]$.
	Any \emph{subsequence} contains strictly less information about $\Set{A}$.
	That is, positive approximate sets are strictly \emph{additive}, and as $n \to \infty$, $\cap_{i=1}^{n} \PASet{A}[\fprate_i]$ converges almost surely to $\Set{A}$.\footnote{Likewise, for negative approximate sets, as $n \to \infty$, $\cup_{i=1}^{n}
		\NASet{A}[\fnrate_i]$ converges almost surely to $\Set{A}$.}
\end{remark}
